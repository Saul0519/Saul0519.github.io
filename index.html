<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>Gift System</title>
<style>
body {
  margin: 0;
  font-family: Pretendard, sans-serif;
  background: #0f1220;
  color: #fff;
}
.container {
  max-width: 420px;
  margin: auto;
  padding: 20px;
}
h2 { margin-top: 30px; }
.box {
  background: #1a1d35;
  border-radius: 12px;
  padding: 15px;
  margin-top: 10px;
}
input, button {
  width: 100%;
  padding: 10px;
  margin-top: 8px;
  border-radius: 8px;
  border: none;
}
button {
  background: #6c7cff;
  color: white;
  cursor: pointer;
}
.gift {
  padding: 10px;
  border-bottom: 1px solid #2c2f55;
  cursor: pointer;
}
.hidden { opacity: 0.6; }
.toggle { margin-top: 10px; }
.admin { background:#222657; }
</style>
</head>
<body>

<div class="container" id="loginBox">
  <h2>ë¡œê·¸ì¸</h2>
  <input id="loginId" placeholder="ID">
  <input id="loginPw" type="password" placeholder="PW">
  <button onclick="doLogin()">Login</button>
</div>

<div class="container" id="app" style="display:none">

  <h2>ğŸ ë³´ìœ  ì¤‘ì¸ ì„ ë¬¼</h2>
  <div class="toggle" id="hideBox" style="display:none">
    <label><input type="checkbox" id="hideToggle"> ??? ìˆ¨ê¸°ê¸°</label>
  </div>
  <div class="box" id="owned"></div>

  <div id="adminPanel" style="display:none">
    <h2>âš™ ê´€ë¦¬ì ì„¤ì •</h2>
    <input id="newGiftName" placeholder="ì„ ë¬¼ ì´ë¦„">
    <input id="newGiftStatus" placeholder="ë°°ì†¡ ìƒíƒœ">
    <button onclick="addOwned()">ì„ ë¬¼ ì¶”ê°€</button>
  </div>

  <h2>ğŸ’­ ë°›ê³  ì‹¶ì€ ì„ ë¬¼</h2>
  <input id="wishInput" placeholder="ë°›ê³  ì‹¶ì€ ì„ ë¬¼">
  <button onclick="addWish()">ì¶”ê°€</button>
  <div class="box" id="wish"></div>
</div>

<script>
const USERS = {
  saul:   { pw:"0519", role:"admin" },
  minseo:{ pw:"1009", role:"user" }
};

let role = "";
let hideUnknown = true;

function doLogin() {
  const id = document.getElementById("loginId").value;
  const pw = document.getElementById("loginPw").value;

  const user = USERS[id];
  if(!user || user.pw !== pw) {
    alert("ë¡œê·¸ì¸ ì‹¤íŒ¨");
    return;
  }

  role = user.role;
  document.getElementById("loginBox").style.display = "none";
  document.getElementById("app").style.display = "block";

  if(role === "admin") {
    document.getElementById("adminPanel").style.display = "block";
    document.getElementById("hideBox").style.display = "block";
  }

  load();
}

function load() {
  hideUnknown = JSON.parse(localStorage.getItem("hide")) ?? true;
  document.getElementById("hideToggle").checked = hideUnknown;
  document.getElementById("hideToggle").onchange = toggleHide;
  renderOwned();
  renderWish();
}

function toggleHide() {
  hideUnknown = document.getElementById("hideToggle").checked;
  localStorage.setItem("hide", hideUnknown);
  renderOwned();
}

function renderOwned() {
  const ownedBox = document.getElementById("owned");
  const data = JSON.parse(localStorage.getItem("owned")) || [];
  ownedBox.innerHTML = "";

  data.forEach((g, i) => {
    const name = (!g.delivered && hideUnknown) ? "???" : g.name;
    const div = document.createElement("div");
    div.className = "gift " + (!g.delivered ? "hidden" : "") + (role==="admin"?" admin":"");
    div.innerText = name;
    div.onclick = () => {
      if(role==="admin") adminGift(i);
      else alert("ë°°ì†¡ ìƒíƒœ: " + g.status);
    };
    ownedBox.appendChild(div);
  });
}

function adminGift(i) {
  const data = JSON.parse(localStorage.getItem("owned"));
  const act = prompt("1: ë°°ì†¡ ìƒíƒœ ë³€ê²½\n2: ë°°ì†¡ ì™„ë£Œ ì²˜ë¦¬", "1");
  if(act==="1") {
    const s = prompt("ìƒˆ ë°°ì†¡ ìƒíƒœ");
    if(s) data[i].status = s;
  }
  if(act==="2") {
    data[i].delivered = true;
    data[i].status = "ë°°ì†¡ ì™„ë£Œ";
  }
  localStorage.setItem("owned", JSON.stringify(data));
  renderOwned();
}

function addOwned() {
  const name = newGiftName.value.trim();
  const status = newGiftStatus.value.trim();
  if(!name || !status) return;
  const data = JSON.parse(localStorage.getItem("owned")) || [];
  data.push({name, status, delivered:false});
  localStorage.setItem("owned", JSON.stringify(data));
  newGiftName.value = "";
  newGiftStatus.value = "";
  renderOwned();
}

function addWish() {
  const v = wishInput.value.trim();
  if(!v) return;
  const data = JSON.parse(localStorage.getItem("wish")) || [];
  data.push(v);
  localStorage.setItem("wish", JSON.stringify(data));
  wishInput.value = "";
  renderWish();
}

function renderWish() {
  const data = JSON.parse(localStorage.getItem("wish")) || [];
  wish.innerHTML = data.map(w=>`<div class="gift">${w}</div>`).join("");
}
</script>

</body>
</html>
